# Baza.ng — Environment Variables
# Copy this to .env in /backend and fill in all values
# NEVER commit .env to Git. Add it to .gitignore immediately.
# 
# Railway auto-provides DATABASE_URL and REDIS_URL when you add plugins.
# All other values must be set manually in Railway's Variables UI.

# ─── DATABASE ────────────────────────────────────────────────────────────────
# PostgreSQL connection string. Railway auto-generates this.
# Format: postgresql://user:password@host:port/database
DATABASE_URL="postgresql://postgres:password@localhost:5432/baza_ng"

# ─── REDIS ───────────────────────────────────────────────────────────────────
# Redis connection string. Railway auto-generates this.
# Format: redis://default:password@host:port
REDIS_URL="redis://localhost:6379"

# ─── JWT AUTH ────────────────────────────────────────────────────────────────
# Generate strong secrets: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# ACCESS secret: used for short-lived access tokens (15 minutes)
JWT_ACCESS_SECRET="replace_with_64_char_random_hex_string"
# REFRESH secret: used for long-lived refresh tokens (30 days)
# MUST be different from ACCESS secret
JWT_REFRESH_SECRET="replace_with_different_64_char_random_hex_string"
# Token expiry durations
JWT_ACCESS_EXPIRY="15m"
JWT_REFRESH_EXPIRY="30d"

# ─── PAYSTACK ────────────────────────────────────────────────────────────────
# From Paystack Dashboard → Settings → API Keys & Webhooks
# Use test keys during development (sk_test_...), live keys for production (sk_live_...)
PAYSTACK_SECRET_KEY="sk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
PAYSTACK_PUBLIC_KEY="pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
# Webhook secret: from Paystack Dashboard → Settings → Webhooks
# Used to verify HMAC-SHA512 signature on incoming webhooks
PAYSTACK_WEBHOOK_SECRET="whsec_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
# Your Paystack subaccount code (if using split payments with kitchen partners)
# Leave empty if not using split payments
PAYSTACK_SUBACCOUNT=""

# ─── SUPABASE (Phone OTP Auth) ────────────────────────────────────────────────
# From Supabase Dashboard → Settings → API
# Enable Phone Auth in: Authentication → Providers → Phone
# Configure an SMS provider (Twilio, MessageBird, Vonage) in the Supabase dashboard
SUPABASE_URL="https://your-project-ref.supabase.co"
SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.your_anon_key"
SUPABASE_SERVICE_ROLE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.your_service_role_key"

# ─── ANTHROPIC (Claude API — support chat) ───────────────────────────────────
# From https://console.anthropic.com
ANTHROPIC_API_KEY="sk-ant-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
# Model to use for support chat. Do not change.
ANTHROPIC_MODEL="claude-sonnet-4-6"

# ─── CLOUDINARY (Product images) ─────────────────────────────────────────────
# From Cloudinary Dashboard → Settings → Access Keys
CLOUDINARY_CLOUD_NAME="your_cloud_name"
CLOUDINARY_API_KEY="your_api_key"
CLOUDINARY_API_SECRET="your_api_secret"
# Upload preset (create in Cloudinary: Settings → Upload → Add upload preset)
CLOUDINARY_UPLOAD_PRESET="baza_products"

# ─── SERVER ──────────────────────────────────────────────────────────────────
PORT="3001"
NODE_ENV="development"   # development | production
# Frontend URL (for CORS). Mobile Expo dev: use tunnel URL
ALLOWED_ORIGINS="http://localhost:8081,https://your-production-domain.com"
# Cookie domain (set to your Railway backend domain in production)
COOKIE_DOMAIN="localhost"

# ─── SLACK (optional — for support chat human escalation alerts) ──────────────
# From Slack → Create App → Incoming Webhooks
# Leave empty to disable Slack notifications
SLACK_WEBHOOK_URL=""

# ─── RATE LIMITING ───────────────────────────────────────────────────────────
# Max OTP requests per phone number per 10 minutes
OTP_RATE_LIMIT="3"
OTP_TTL_SECONDS="300"

# ─── REFERRAL ────────────────────────────────────────────────────────────────
# In kobo (₦1 = 100 kobo)
REFERRAL_CREDIT_REFERRER="200000"   # ₦2,000 for the person who referred
REFERRAL_CREDIT_REFEREE="100000"    # ₦1,000 for the new member

# ─── MOBILE (.env in /mobile — use EXPO_PUBLIC_ prefix for client-side vars) ─
# These go in mobile/.env, not backend/.env
EXPO_PUBLIC_API_URL="http://localhost:3001/v1"
EXPO_PUBLIC_PAYSTACK_PUBLIC_KEY="pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
EXPO_PUBLIC_APP_NAME="Baza"
EXPO_PUBLIC_SUPPORT_EMAIL="support@baza.ng"
